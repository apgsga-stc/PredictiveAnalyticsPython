WITH plz_vkgeb AS (
    SELECT '1001' plz, 'V-W03' verkaufs_gebiets_code FROM dual UNION 
    SELECT '1002' plz, 'V-W03' verkaufs_gebiets_code FROM dual UNION 
    SELECT '1014' plz, 'V-W02' verkaufs_gebiets_code FROM dual UNION
    SELECT '1211' plz, 'V-W01' verkaufs_gebiets_code FROM dual UNION
    SELECT '1251' plz, 'V-W02' verkaufs_gebiets_code FROM dual UNION
    SELECT '1401' plz, 'V-W02' verkaufs_gebiets_code FROM dual UNION 
    SELECT '1701' plz, 'V-W04' verkaufs_gebiets_code FROM dual UNION 
    SELECT '1705' plz, 'V-W04' verkaufs_gebiets_code FROM dual UNION 
    SELECT '1709' plz, 'V-W04' verkaufs_gebiets_code FROM dual UNION 
    SELECT '1951' plz, 'V-W05' verkaufs_gebiets_code FROM dual UNION 
    SELECT '2001' plz, 'V-W04' verkaufs_gebiets_code FROM dual UNION
    SELECT '2002' plz, 'V-W04' verkaufs_gebiets_code FROM dual UNION
    SELECT '2006' plz, 'V-W04' verkaufs_gebiets_code FROM dual UNION
    SELECT '2301' plz, 'V-W04' verkaufs_gebiets_code FROM dual UNION 
    SELECT '2302' plz, 'V-W04' verkaufs_gebiets_code FROM dual UNION 
    SELECT '2304' plz, 'V-W04' verkaufs_gebiets_code FROM dual UNION 
    SELECT '2500' plz, 'V-M03' verkaufs_gebiets_code FROM dual UNION
    SELECT '2501' plz, 'V-M03' verkaufs_gebiets_code FROM dual UNION 
    SELECT '3000' plz, 'V-M04' verkaufs_gebiets_code FROM dual UNION
    SELECT '3001' plz, 'V-M04' verkaufs_gebiets_code FROM dual UNION 
    SELECT '3003' plz, 'V-M04' verkaufs_gebiets_code FROM dual UNION 
    SELECT '3030' plz, 'V-M04' verkaufs_gebiets_code FROM dual UNION 
    SELECT '3050' plz, 'V-M04' verkaufs_gebiets_code FROM dual UNION 
    SELECT '3321' plz, 'V-M03' verkaufs_gebiets_code FROM dual UNION
    SELECT '3601' plz, 'V-M05' verkaufs_gebiets_code FROM dual UNION 
    SELECT '3602' plz, 'V-M05' verkaufs_gebiets_code FROM dual UNION 
    SELECT '3607' plz, 'V-M05' verkaufs_gebiets_code FROM dual UNION 
    SELECT '4002' plz, 'V-M01' verkaufs_gebiets_code FROM dual UNION 
    SELECT '4005' plz, 'V-M01' verkaufs_gebiets_code FROM dual UNION 
    SELECT '4009' plz, 'V-M01' verkaufs_gebiets_code FROM dual UNION 
    SELECT '4010' plz, 'V-M01' verkaufs_gebiets_code FROM dual UNION 
    SELECT '4011' plz, 'V-M01' verkaufs_gebiets_code FROM dual UNION 
    SELECT '4012' plz, 'V-M01' verkaufs_gebiets_code FROM dual UNION 
    SELECT '4013' plz, 'V-M01' verkaufs_gebiets_code FROM dual UNION 
    SELECT '4016' plz, 'V-M01' verkaufs_gebiets_code FROM dual UNION 
    SELECT '4018' plz, 'V-M01' verkaufs_gebiets_code FROM dual UNION 
    SELECT '4019' plz, 'V-M01' verkaufs_gebiets_code FROM dual UNION 
    SELECT '4020' plz, 'V-M01' verkaufs_gebiets_code FROM dual UNION 
    SELECT '4023' plz, 'V-M01' verkaufs_gebiets_code FROM dual UNION 
    SELECT '4031' plz, 'V-M01' verkaufs_gebiets_code FROM dual UNION 
    SELECT '4501' plz, 'V-M03' verkaufs_gebiets_code FROM dual UNION 
    SELECT '4502' plz, 'V-M03' verkaufs_gebiets_code FROM dual UNION 
    SELECT '4503' plz, 'V-M03' verkaufs_gebiets_code FROM dual UNION 
    SELECT '4601' plz, 'V-M03' verkaufs_gebiets_code FROM dual UNION 
    SELECT '4603' plz, 'V-M03' verkaufs_gebiets_code FROM dual UNION 
    SELECT '4901' plz, 'V-M03' verkaufs_gebiets_code FROM dual UNION 
    SELECT '4902' plz, 'V-M03' verkaufs_gebiets_code FROM dual UNION 
    SELECT '5001' plz, 'V-M06' verkaufs_gebiets_code FROM dual UNION 
    SELECT '5201' plz, 'V-M06' verkaufs_gebiets_code FROM dual UNION
    SELECT '5232' plz, 'V-M06' verkaufs_gebiets_code FROM dual UNION
    SELECT '5401' plz, 'V-M06' verkaufs_gebiets_code FROM dual UNION 
    SELECT '5402' plz, 'V-M06' verkaufs_gebiets_code FROM dual UNION 
    SELECT '6000' plz, 'V-M07' verkaufs_gebiets_code FROM dual UNION
    SELECT '6002' plz, 'V-M07' verkaufs_gebiets_code FROM dual UNION 
    SELECT '6021' plz, 'V-M07' verkaufs_gebiets_code FROM dual UNION
    SELECT '6061' plz, 'V-M08' verkaufs_gebiets_code FROM dual UNION
    SELECT '6301' plz, 'V-O01' verkaufs_gebiets_code FROM dual UNION 
    SELECT '6302' plz, 'V-O01' verkaufs_gebiets_code FROM dual UNION 
    SELECT '6304' plz, 'V-O01' verkaufs_gebiets_code FROM dual UNION 
    SELECT '6341' plz, 'V-O01' verkaufs_gebiets_code FROM dual UNION 
    SELECT '6405' plz, 'V-M08' verkaufs_gebiets_code FROM dual UNION 
    SELECT '6431' plz, 'V-M08' verkaufs_gebiets_code FROM dual UNION 
    SELECT '6501' plz, 'V-S01' verkaufs_gebiets_code FROM dual UNION 
    SELECT '6601' plz, 'V-S01' verkaufs_gebiets_code FROM dual UNION 
    SELECT '6604' plz, 'V-S01' verkaufs_gebiets_code FROM dual UNION 
    SELECT '6836' plz, 'V-S02' verkaufs_gebiets_code FROM dual UNION
    SELECT '6901' plz, 'V-S02' verkaufs_gebiets_code FROM dual UNION 
    SELECT '6902' plz, 'V-S02' verkaufs_gebiets_code FROM dual UNION 
    SELECT '6903' plz, 'V-S02' verkaufs_gebiets_code FROM dual UNION 
    SELECT '6904' plz, 'V-S02' verkaufs_gebiets_code FROM dual UNION 
    SELECT '7001' plz, 'V-O05' verkaufs_gebiets_code FROM dual UNION 
    SELECT '7002' plz, 'V-O05' verkaufs_gebiets_code FROM dual UNION 
    SELECT '7004' plz, 'V-O05' verkaufs_gebiets_code FROM dual UNION 
    SELECT '7006' plz, 'V-O05' verkaufs_gebiets_code FROM dual UNION 
    SELECT '7007' plz, 'V-O05' verkaufs_gebiets_code FROM dual UNION 
    SELECT '8010' plz, 'V-O01' verkaufs_gebiets_code FROM dual UNION
    SELECT '8021' plz, 'V-O01' verkaufs_gebiets_code FROM dual UNION 
    SELECT '8022' plz, 'V-O01' verkaufs_gebiets_code FROM dual UNION 
    SELECT '8023' plz, 'V-O01' verkaufs_gebiets_code FROM dual UNION 
    SELECT '8024' plz, 'V-O01' verkaufs_gebiets_code FROM dual UNION 
    SELECT '8026' plz, 'V-O01' verkaufs_gebiets_code FROM dual UNION 
    SELECT '8027' plz, 'V-O01' verkaufs_gebiets_code FROM dual UNION 
    SELECT '8031' plz, 'V-O01' verkaufs_gebiets_code FROM dual UNION 
    SELECT '8034' plz, 'V-O01' verkaufs_gebiets_code FROM dual UNION 
    SELECT '8036' plz, 'V-O01' verkaufs_gebiets_code FROM dual UNION 
    SELECT '8040' plz, 'V-O01' verkaufs_gebiets_code FROM dual UNION 
    SELECT '8042' plz, 'V-O01' verkaufs_gebiets_code FROM dual UNION 
    SELECT '8058' plz, 'V-O01' verkaufs_gebiets_code FROM dual UNION 
    SELECT '8060' plz, 'V-O02' verkaufs_gebiets_code FROM dual UNION
    SELECT '8066' plz, 'V-O02' verkaufs_gebiets_code FROM dual UNION 
    SELECT '8070' plz, 'V-O02' verkaufs_gebiets_code FROM dual UNION 
    SELECT '8080' plz, 'V-O02' verkaufs_gebiets_code FROM dual UNION
    SELECT '8081' plz, 'V-O02' verkaufs_gebiets_code FROM dual UNION 
    SELECT '8085' plz, 'V-O02' verkaufs_gebiets_code FROM dual UNION 
    SELECT '8087' plz, 'V-O02' verkaufs_gebiets_code FROM dual UNION 
    SELECT '8090' plz, 'V-O02' verkaufs_gebiets_code FROM dual UNION 
    SELECT '8091' plz, 'V-O02' verkaufs_gebiets_code FROM dual UNION 
    SELECT '8092' plz, 'V-O02' verkaufs_gebiets_code FROM dual UNION 
    SELECT '8093' plz, 'V-O02' verkaufs_gebiets_code FROM dual UNION 
    SELECT '8098' plz, 'V-O02' verkaufs_gebiets_code FROM dual UNION 
    SELECT '8201' plz, 'V-O03' verkaufs_gebiets_code FROM dual UNION 
    SELECT '8238' plz, 'V-O03' verkaufs_gebiets_code FROM dual UNION 
    SELECT '8301' plz, 'V-O02' verkaufs_gebiets_code FROM dual UNION
    SELECT '8401' plz, 'V-O03' verkaufs_gebiets_code FROM dual UNION 
    SELECT '8402' plz, 'V-O03' verkaufs_gebiets_code FROM dual UNION 
    SELECT '8403' plz, 'V-O03' verkaufs_gebiets_code FROM dual UNION 
    SELECT '8410' plz, 'V-O03' verkaufs_gebiets_code FROM dual UNION 
    SELECT '8501' plz, 'V-O03' verkaufs_gebiets_code FROM dual UNION 
    SELECT '8502' plz, 'V-O03' verkaufs_gebiets_code FROM dual UNION 
    SELECT '8503' plz, 'V-O03' verkaufs_gebiets_code FROM dual UNION 
    SELECT '8510' plz, 'V-O03' verkaufs_gebiets_code FROM dual UNION 
    SELECT '8612' plz, 'V-O02' verkaufs_gebiets_code FROM dual UNION
    SELECT '8622' plz, 'V-O03' verkaufs_gebiets_code FROM dual UNION
    SELECT '9001' plz, 'V-O04' verkaufs_gebiets_code FROM dual UNION 
    SELECT '9004' plz, 'V-O04' verkaufs_gebiets_code FROM dual UNION 
    SELECT '9006' plz, 'V-O04' verkaufs_gebiets_code FROM dual UNION 
    SELECT '9007' plz, 'V-O04' verkaufs_gebiets_code FROM dual UNION 
    SELECT '9013' plz, 'V-O04' verkaufs_gebiets_code FROM dual UNION  
    SELECT '9201' plz, 'V-O04' verkaufs_gebiets_code FROM dual UNION
    SELECT '9471' plz, 'V-O04' verkaufs_gebiets_code FROM dual UNION
    SELECT '9501' plz, 'V-O04' verkaufs_gebiets_code FROM dual )
SELECT /*+ Predictive Analytics: Read PLZ data */
    pg.plz, NULL fraktion, NULL ort, pg.verkaufs_gebiets_code, gp.ma_kurzzeichen vb_vkgeb 
    FROM plz_vkgeb               pg
    JOIN gebiete_tot_v           gb ON pg.verkaufs_gebiets_code = gb.gebiet_code AND TRUNC(SYSDATE) BETWEEN gb.gueltig_von AND gb.gueltig_bis
    JOIN fm.geb_ma_zuordnungen_v gm ON gb.gbot_oid = gm.gbot_oid AND gm.geb_zustaendigkeit = 1
    JOIN geschpartner_all_tot_v  gp ON gm.subt_oid = gp.subt_oid AND TRUNC(SYSDATE) BETWEEN gp.gueltig_von AND gp.gueltig_bis
UNION
    SELECT DISTINCT to_char(plz.plz) plz,
        plz.bezeichnung     fraktion,
        ort.geb_bezeichnung ort,
        geb.geb_gebiet_code verkaufs_gebiets_code,
        gp.ma_kurzzeichen   vb_vkgeb 
    FROM plz_blattgeb_mapping_v plz 
    LEFT JOIN gebiete_blatt_tot_v     geb ON plz.gbot_oid = geb.blatt_gbot_oid AND TRUNC(SYSDATE) BETWEEN geb.gueltig_von AND geb.gueltig_bis AND geb.geb_gbat_id = 751
    LEFT JOIN fm.geb_ma_zuordnungen_v gm  ON geb.geb_gbot_oid = gm.gbot_oid AND gm.geb_zustaendigkeit = 1
    LEFT JOIN geschpartner_all_bs_v   gp  ON gm.subt_oid = gp.subt_oid 
    LEFT JOIN gebiete_blatt_tot_v     ort ON plz.gbot_oid = ort.blatt_gbot_oid AND TRUNC(SYSDATE) BETWEEN ort.gueltig_von AND ort.gueltig_bis AND ort.geb_gbat_id = 4   
    WHERE TRUNC(SYSDATE) BETWEEN plz.gueltig_von AND plz.gueltig_bis
